/*! Twitch Chat Emotes v0.5.14, 2014-04-04, https://github.com/cletusc/Userscript--Twitch-Chat-Emotes  */
!function a(b,c,d){"use strict";function e(){return O="undefined"==typeof b.CurrentChat,C=D=b.$j,O?(E=C(".send-chat-button"),F=C(".chat-buttons-container .chat-option-buttons"),G=C(".chat-interface textarea")):(E=C("#chat_speak"),F=C("#control_buttons"),G=C("#control_input")),E.length?(r(),f(),u(B.style.render()),g(),q(),void b.Twitch.api.get("/api/users/:login/tickets").done(function(a){y(a,"Response from `/api/user/:login/tickets`.",!0),a.tickets.forEach(function(a){if(a.product.emoticons&&a.product.emoticons.length){var b=a.product.features.badge,c=a.product.owner_name;b&&(J.subscriptions.badges[c]="http://static-cdn.jtvnw.net/jtv_user_pictures/"+[b.prefix,b.owner,b.type,b.uid,b.sizes[0]].join("-")+"."+b.format),a.product.emoticons.forEach(function(a){J.subscriptions.emotes[s(new RegExp(a.regex))]={channel:c,url:a.url}})}})})):void console.warn(P.NO_CHAT_ELEMENT)}function f(){H=C(B.emoteButton.render({isEmber:O})),O?H.appendTo(F):H.insertBefore(E),H.hide(),E.hasClass("cap")?(G.animate({"margin-right":"175px"}),F.css("width","175px"),E.animate({"margin-right":"51px"},{complete:function(){E.css("margin-right","5px"),H.css("margin-right","5px").fadeIn()}})):O?b.BetterTTV?H.fadeIn():E.animate({left:"121px"},{complete:function(){H.fadeIn()}}):E.css("float","right").animate({width:"149px"},{complete:function(){H.fadeIn()}}),I=C(B.menu.render()),I.appendTo(document.body)}function g(){H.popup("click_to_close",I,{above:!0}),H.on("click",function(){if(I.removeClass("has_moved"),I.is(":visible"))if(C(this).addClass("active"),I.hasClass("not_default_location"))I.offset(JSON.parse(I.attr("data-offset")));else{var a=I.height()-I.find(".emotes-all").height(),b=null;b=C(O?".chat-messages":"#chat_lines"),I.height(b.outerHeight()-(I.outerHeight()-I.height())),I.width(C("#speak, .chat-messages").outerWidth()-(I.outerWidth()-I.width())),I.offset(b.offset()),I.find(".emotes-all").height(I.height()-a),I.find(".emotes-all").width(I.width()),I.find(".scroll.emotes-all").TrackpadScrollEmulator("recalculate")}else C(this).removeClass("active");h()}),I.on("clickoutside",function(){!C(this).hasClass("has_moved")&&C(this).is(":visible")&&H.click()}),I.draggable({handle:".draggable",start:function(){C(this).addClass("has_moved"),C(this).addClass("not_default_location")},stop:function(){I.attr("data-offset",JSON.stringify(I.offset()))},containment:C(document.body)}),I.resizable({resize:function(){C(this).addClass("has_moved"),C(this).addClass("not_default_location"),I.find(".scroll.emotes-all").TrackpadScrollEmulator("recalculate")},alsoResize:I.find(".emotes-all"),containment:C(document.body),minHeight:180,minWidth:200}),I.find(".dropmenu_alt_section a.reset").on("click",function(){m(),h()}),I.find(".dropmenu_alt_section a.popular-emotes-location").on("click",function(){var a=+v("emote-popular-on-top",1);w("emote-popular-on-top",a?0:1),i(!a)}),I.on("click",".userscript_emoticon",function(){o(C(this).attr("data-emote"))}),I.find(".scroll.emotes-all").TrackpadScrollEmulator({scrollbarHideStrategy:"rightAndBottom"})}function h(){function a(a,c){var d=l(a.text),e=l(c.text),f="number"==typeof d,g="number"==typeof e;return f&&!g?-1:g&&!f?1:e>d?1:d>e?-1:b(a,c)}function b(a,b){return a=a.text,b=b.text,a.toLowerCase()<b.toLowerCase()?-1:a.toLowerCase()>b.toLowerCase()?1:b>a?-1:a>b?1:0}function c(a,c){if(a.channel&&"Twitch Turbo"===a.channel&&(!c.channel||c.channel&&"Twitch Turbo"!==c.channel))return-1;if(c.channel&&"Twitch Turbo"===c.channel&&(!a.channel||a.channel&&"Twitch Turbo"!==a.channel))return 1;var d=[":(",":)",":/",":D",":o",":p",":z",";)",";p","<3",">(","B)","R)","o_o"];if(d.indexOf(a.text)>=0&&d.indexOf(c.text)<0)return-1;if(d.indexOf(c.text)>=0&&d.indexOf(a.text)<0)return 1;if(a.channel&&!c.channel)return 1;if(c.channel&&!a.channel)return-1;if(a.channel&&c.channel){if(J.subscriptions.badges[a.channel]&&!J.subscriptions.badges[c.channel])return-1;if(J.subscriptions.badges[c.channel]&&!J.subscriptions.badges[a.channel])return 1;var e=b({text:a.channel},{text:c.channel}),f=b(a,c);return 0===e?f:e}return b(a,c)}var d;i(+v("emote-popular-on-top",!0)),j(),d=I.find(".emotes-popular .emotes-container"),d.html(""),J.usable.sort(a),J.usable.forEach(function(a){p(a,d)}),d=I.find(".emotes-all .emotes-container"),d.html(""),J.usable.sort(c),J.usable.forEach(function(a){p(a,d,!0)})}function i(a){var b=I.find(".emotes-popular"),c=I.find(".emotes-popular").prev(),d=I.find(".emotes-all"),e=I.find(".popular-emotes-location");a?(c.insertBefore(d.prev()),b.insertBefore(d.prev()),e.removeClass("popular-on-bottom")):(b.insertAfter(d),c.insertAfter(d),e.addClass("popular-on-bottom"))}function j(){J.usable=[],J.raw.forEach(function(a){if(!a.hidden){a.text||(a.text=s(a.regex)),J.subscriptions.emotes[a.text]&&(a.channel=J.subscriptions.emotes[a.text].channel);var b;a.images.some(function(c){return null===c.emoticon_set&&(b=c),J.subscriptions.emotes[a.text]&&c.url===J.subscriptions.emotes[a.text].url?(a.image=c,!0):void 0}),a.image=a.image||b,a.image&&!a.image.html&&(a.image.html='<img src="'+a.image.url+'">'),a.image&&null!==a.image.url&&J.usable.push(a)}})}function k(a,b){n(),K[a]===d&&(K[a]=0),"number"==typeof b&&b>=0?K[a]=b:K[a]++,w("emote-popularity-tracking",JSON.stringify(K))}function l(a){return n(),"number"==typeof K[a]&&K[a]>=0?K[a]:!1}function m(){x("emote-popularity-tracking"),K=!1,n()}function n(){K||(K=JSON.parse(v("emote-popularity-tracking","{}")),k("BibleThump",0),k("DansGame",0),k("FailFish",0),k("Kappa",0),k("Kreygasm",0),k("SwiftRage",0))}function o(a){k(a);var c=document.querySelector("#chat_text_input, .chat-interface textarea"),d=c.selectionStart+a.length,e=c.value,f=e.substring(0,c.selectionStart),g=e.substring(c.selectionEnd,e.length);""!==f&&" "!==f.substr(-1)&&(a=" "+a),a=f+a+" "+g,O?b.App.__container__.lookup("controller:chat").get("currentRoom").set("messageToSend",a):c.value=a,c.focus(),d=c.selectionStart+a.length,c.setSelectionRange(d,d),I.hasClass("has_moved")?h():H.click()}function p(a,b,c){if(a&&a.image&&b.length){if(c&&a.channel&&"Twitch Turbo"!==a.channel){var d=J.subscriptions.badges[a.channel]||a.badge||"https://static-cdn.jtvnw.net/jtv_user_pictures/subscriber-star.png";J.subscriptions.badges[a.channel]||I.find(".userscript_emoticon_header.addon-emotes-header").length||b.append(C(B.emoteGroupHeader.render({isAddonHeader:!0}))),I.find('.userscript_emoticon_header[data-emote-channel="'+a.channel+'"]').length||b.append(C(B.emoteGroupHeader.render({badge:d,channel:a.channel})))}b.append(C(B.emote.render({image:a.image.html,text:a.text})))}}function q(){function a(){for(var a in c)c.hasOwnProperty(a)&&-1===b.indexOf(a)&&t(B.newsMessage.render({scriptName:M,message:c[a],id:a}),!0);C("#chat_lines, .chat-messages").on("click",'a[data-command="twitch-chat-emotes:dismiss-news"]',function(a){a.preventDefault(),b.push(C(this).data("news-id")),w("twitch-chat-emotes:dismissed-news",JSON.stringify(b)),C(this).parent().parent().remove()})}var b=JSON.parse(v("twitch-chat-emotes:dismissed-news","[]")),c=JSON.parse(v("twitch-chat-emotes:cached-news","{}"));N||Date.now()-v("twitch-chat-emotes:news-date",0)>864e5?C.ajax("https://api.github.com/repos/cletusc/Userscript--Twitch-Chat-Emotes/contents/news.json",{dataType:"json",headers:{Accept:"application/vnd.github.v3.raw+json","User-Agent":"cletusc/Userscript--Twitch-Chat-Emotes"}}).done(function(a){c=a||c,w("twitch-chat-emotes:cached-news",JSON.stringify(c))}).always(function(){a(),w("twitch-chat-emotes:news-date",Date.now())}):a()}function r(){!function(a){a.fn.resizable=function(b){function c(a){var b=a.data,c={};b.diffX=Math.round((a.pageX-b.pageX)/f.snapSize)*f.snapSize,b.diffY=Math.round((a.pageY-b.pageY)/f.snapSize)*f.snapSize,(Math.abs(b.diffX)>0||Math.abs(b.diffY)>0)&&(f.element.height()!==b.height+b.diffY&&b.height+b.diffY>=f.minHeight&&b.height+b.diffY<=f.maxHeight&&(f.containment?b.outerHeight+b.diffY+b.offset.top<=f.containment.offset().top+f.containment.outerHeight():!0)&&(f.element.height(b.height+b.diffY),c.height=!0),f.element.width()!==b.width+b.diffX&&b.width+b.diffX>=f.minWidth&&b.width+b.diffX<=f.maxWidth&&(f.containment?b.outerWidth+b.diffX+b.offset.left<=f.containment.offset().left+f.containment.outerWidth():!0)&&(f.element.width(b.width+b.diffX),c.width=!0),(c.height||c.width)&&(f.resizeOnce&&(f.resizeOnce.bind(f.element)(a.data),f.resizeOnce=null),f.resize&&f.resize.bind(f.element)(a.data),f.alsoResize&&(!c.height||"height"!==f.alsoResizeType&&"both"!==f.alsoResizeType||f.alsoResize.height(b.alsoResizeHeight+b.diffY),!c.width||"width"!==f.alsoResizeType&&"both"!==f.alsoResizeType||f.alsoResize.width(b.alsoResizeWidth+b.diffX))))}function d(b){b.preventDefault(),f.start&&f.start.bind(f.element)();var d={alsoResizeHeight:f.alsoResize?f.alsoResize.height():0,alsoResizeWidth:f.alsoResize?f.alsoResize.width():0,height:f.element.height(),offset:f.element.offset(),outerHeight:f.element.outerHeight(),outerWidth:f.element.outerWidth(),pageX:b.pageX,pageY:b.pageY,width:f.element.width()};a(document).on("mousemove","*",d,c),a(document).on("mouseup","*",e)}function e(){f.stop&&f.stop.bind(f.element)(),a(document).off("mousemove","*",c),a(document).off("mouseup","*",e)}var f=a.extend({alsoResize:null,alsoResizeType:"both",containment:null,create:null,destroy:null,handle:".resize-handle",maxHeight:9999,maxWidth:9999,minHeight:0,minWidth:0,resize:null,resizeOnce:null,snapSize:1,start:null,stop:null},b);if(f.element=a(this),f.handle){if(f.alsoResize&&["both","height","width"].indexOf(f.alsoResizeType)>=0&&(f.alsoResize=a(f.alsoResize)),f.containment&&(f.containment=a(f.containment)),f.handle=a(f.handle),f.snapSize=f.snapSize<1?1:f.snapSize,"destroy"===b)return f.handle.off("mousedown",d),f.destroy&&f.destroy.bind(this)(),this;f.handle.on("mousedown",d),f.create&&f.create.bind(this)()}return this}}(D),C.fn.TrackpadScrollEmulator||!function(a){function c(c,f){function g(){B.hasClass("horizontal")&&(D="horiz",E="scrollLeft",F="width",G="left"),B.prepend('<div class="tse-scrollbar"><div class="drag-handle"></div></div>'),w=B.find(".tse-scrollbar"),x=B.find(".drag-handle"),f.wrapContent&&C.wrap('<div class="tse-scroll-content" />'),v=B.find(".tse-scroll-content"),p(),B.on("mouseenter",m),x.on("mousedown",h),v.on("scroll",k),l()}function h(b){b.preventDefault();var c=b.pageY;"horiz"===D&&(c=b.pageX),y=c-x.offset()[G],a(document).on("mousemove",i),a(document).on("mouseup",j)}function i(a){a.preventDefault();var b=a.pageY;"horiz"===D&&(b=a.pageX);var c=b-w.offset()[G]-y,d=c/w[F](),e=d*C[F]();v[E](e)}function j(){a(document).off("mousemove",i),a(document).off("mouseup",j)}function k(){m()}function l(){var a=C[F](),b=v[E](),c=w[F](),d=c/a,e=Math.round(d*b)+2,f=Math.floor(d*(c-2))-2;a>c?(x.css("vert"===D?{top:e,height:f}:{left:e,width:f}),w.show()):w.hide()}function m(){l(),n()}function n(){x.addClass("visible"),"number"==typeof z&&b.clearTimeout(z),z=b.setTimeout(function(){o()},1e3)}function o(){x.removeClass("visible"),"number"==typeof z&&b.clearTimeout(z)}function p(){"vert"===D?(v.width(B.width()+q()),v.height(B.height())):(v.width(B.width()),v.height(B.height()+q()),C.height(B.height()))}function q(){var b=a('<div class="scrollbar-width-tester" style="width:50px;height:50px;overflow-y:scroll;position:absolute;top:-200px;left:-200px;"><div style="height:100px;"></div>');a("body").append(b);var c=a(b).innerWidth(),d=a("div",b).innerWidth();return b.remove(),c-d}function r(){p(),l()}function s(a,b){return b?void(f[a]=b):f[a]}function t(){C.insertBefore(w),w.remove(),v.remove(),C.css({height:B.height()+"px","overflow-y":"scroll"}),u("onDestroy"),B.removeData("plugin_"+e)}function u(a){f[a]!==d&&f[a].call(A)}var v,w,x,y,z,A=c,B=a(c),C=B.find(".tse-content"),D="vert",E="scrollTop",F="height",G="top";return f=a.extend({},a.fn[e].defaults,f),g(),{option:s,destroy:t,recalculate:r}}var e="TrackpadScrollEmulator";a.fn[e]=function(b){if("string"==typeof arguments[0]){var f,g=arguments[0],h=Array.prototype.slice.call(arguments,1);return this.each(function(){if(!a.data(this,"plugin_"+e)||"function"!=typeof a.data(this,"plugin_"+e)[g])throw new Error("Method "+g+" does not exist on jQuery."+e);f=a.data(this,"plugin_"+e)[g].apply(this,h)}),f!==d?f:this}return"object"!=typeof b&&b?void 0:this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new c(this,b))})},a.fn[e].defaults={onInit:function(){},onDestroy:function(){},wrapContent:!0}}(D)}function s(a){return"string"==typeof a&&(a=new RegExp(a)),decodeURI(a.source).replace("&gt\\;",">").replace("&lt\\;","<").replace(/\(\?![^)]*\)/g,"").replace(/\(([^|])*\|?[^)]*\)/g,"$1").replace(/\[([^|])*\|?[^\]]*\]/g,"$1").replace(/[^\\]\?/g,"").replace(/^\\b|\\b$/g,"").replace(/\\/g,"")}function t(a,c){if("undefined"!=typeof b.CurrentChat)return b.CurrentChat.admin_message(a);if(O){var d=App.__container__.lookup("controller:chat");if(c){var e=location.href+"#admin-message-workaround-"+Math.random();return d.currentRoom.addTmiMessage(e),setTimeout(function(){C('a[href="'+e+'"]').get(0).outerHTML=a},0),!0}return d.currentRoom.addTmiMessage(a)}return console.log(a)}function u(a){var b=document.createElement("style");b.textContent=a,document.querySelector("head").appendChild(b)}function v(a,b){var c=localStorage.getItem(a);return null===c&&"undefined"!=typeof b?b:c}function w(a,b){localStorage.setItem(a,b)}function x(a){localStorage.removeItem(a)}function y(a,b,c){N&&console.log("[DEBUG]["+(M||"UNKNOWN SCRIPT")+"]: "+(b||""),c?JSON.stringify(a):a)}if(c){var z=document.createElement("script");return z.textContent="("+a+")(window, false)",document.body.appendChild(z),void document.body.removeChild(z)}var A={};!function(a,b){function c(a){return String(null===a||void 0===a?"":a)}function d(a){return a=c(a),j.test(a)?a.replace(e,"&amp;").replace(f,"&lt;").replace(g,"&gt;").replace(h,"&#39;").replace(i,"&quot;"):a}a.Template=function(a,c,d,e){this.r=a||this.r,this.c=d,this.options=e,this.text=c||"",this.buf=b?[]:""},a.Template.prototype={r:function(){return""},v:d,t:c,render:function(a,b,c){return this.ri([a],b||{},c)},ri:function(a,b,c){return this.r(a,b,c)},rp:function(a,b,c,d){var e=c[a];return e?(this.c&&"string"==typeof e&&(e=this.c.compile(e,this.options)),e.ri(b,c,d)):""},rs:function(a,b,c){var d=a[a.length-1];if(!k(d))return void c(a,b,this);for(var e=0;e<d.length;e++)a.push(d[e]),c(a,b,this),a.pop()},s:function(a,b,c,d,e,f,g){var h;return k(a)&&0===a.length?!1:("function"==typeof a&&(a=this.ls(a,b,c,d,e,f,g)),h=""===a||!!a,!d&&h&&b&&b.push("object"==typeof a?a:b[b.length-1]),h)},d:function(a,b,c,d){var e=a.split("."),f=this.f(e[0],b,c,d),g=null;if("."===a&&k(b[b.length-2]))return b[b.length-1];for(var h=1;h<e.length;h++)f&&"object"==typeof f&&e[h]in f?(g=f,f=f[e[h]]):f="";return d&&!f?!1:(d||"function"!=typeof f||(b.push(g),f=this.lv(f,b,c),b.pop()),f)},f:function(a,b,c,d){for(var e=!1,f=null,g=!1,h=b.length-1;h>=0;h--)if(f=b[h],f&&"object"==typeof f&&a in f){e=f[a],g=!0;break}return g?(d||"function"!=typeof e||(e=this.lv(e,b,c)),e):d?!1:""},ho:function(a,b,c,d,e){var f=this.c,g=this.options;g.delimiters=e;var d=a.call(b,d);return d=null==d?String(d):d.toString(),this.b(f.compile(d,g).render(b,c)),!1},b:b?function(a){this.buf.push(a)}:function(a){this.buf+=a},fl:b?function(){var a=this.buf.join("");return this.buf=[],a}:function(){var a=this.buf;return this.buf="",a},ls:function(a,b,c,d,e,f,g){var h=b[b.length-1],i=null;if(!d&&this.c&&a.length>0)return this.ho(a,h,c,this.text.substring(e,f),g);if(i=a.call(h),"function"==typeof i){if(d)return!0;if(this.c)return this.ho(i,h,c,this.text.substring(e,f),g)}return i},lv:function(a,b,d){var e=b[b.length-1],f=a.call(e);return"function"==typeof f&&(f=c(f.call(e)),this.c&&~f.indexOf("{{"))?this.c.compile(f,this.options).render(e,d):c(f)}};var e=/&/g,f=/</g,g=/>/g,h=/\'/g,i=/\"/g,j=/[&<>\"\']/,k=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}}("undefined"!=typeof exports?exports:A);var B={};B.emote=new A.Template(function(a,b,c){var d=this;return d.b(c=c||""),d.b('<div class="userscript_emoticon" data-emote="'),d.b(d.v(d.f("text",a,b,0))),d.b('" title="'),d.b(d.v(d.f("text",a,b,0))),d.b('">\r'),d.b("\n"+c),d.b("	"),d.b(d.t(d.f("image",a,b,0))),d.b("\r"),d.b("\n"+c),d.b("</div>\r"),d.b("\n"),d.fl()}),B.emoteButton=new A.Template(function(a,b,c){var d=this;return d.b(c=c||""),d.s(d.f("isEmber",a,b,1),a,b,0,12,134,"{{ }}")&&(d.rs(a,b,function(a,b,c){c.b('	<button class="newlayout emotemenu button normal_button" title="Emote Menu" id="chat_emote_dropmenu_button"></button>\r'),c.b("\n")}),a.pop()),d.s(d.f("isEmber",a,b,1),a,b,1,0,0,"")||(d.b('	<a class="dropdown_glyph" id="chat_emote_dropmenu_button"><span>emotes</span></a>\r'),d.b("\n")),d.fl()}),B.emoteGroupHeader=new A.Template(function(a,b,c){var d=this;return d.b(c=c||""),d.s(d.f("isAddonHeader",a,b,1),a,b,0,18,232,"{{ }}")&&(d.rs(a,b,function(a,b,d){d.b('	<div class="userscript_emoticon_header addon-emotes-header" title="Below are emotes added by an addon. Only those who also have the same addon installed can see these emotes in chat.">\r'),d.b("\n"+c),d.b("		Addon Emotes\r"),d.b("\n"+c),d.b("	</div>\r"),d.b("\n")}),a.pop()),d.b("\r"),d.b("\n"+c),d.s(d.f("isAddonHeader",a,b,1),a,b,1,0,0,"")||(d.b('	<div class="userscript_emoticon_header" data-emote-channel="'),d.b(d.v(d.f("channel",a,b,0))),d.b('"><img src="'),d.b(d.v(d.f("badge",a,b,0))),d.b('" />'),d.b(d.v(d.f("channel",a,b,0))),d.b("</div>\r"),d.b("\n")),d.fl()}),B.menu=new A.Template(function(a,b,c){var d=this;return d.b(c=c||""),d.b('<div class="dropmenu" id="chat_emote_dropmenu">\r'),d.b("\n"+c),d.b('	<div class="draggable"></div>\r'),d.b("\n"+c),d.b('	<div class="userscript_emoticon_header">Popular Emotes</div>\r'),d.b("\n"+c),d.b('	<div class="scroll emotes-popular">\r'),d.b("\n"+c),d.b('		<div class="tse-content emotes-container"></div>\r'),d.b("\n"+c),d.b("	</div>\r"),d.b("\n"+c),d.b('	<div class="userscript_emoticon_header">All Emotes</div>\r'),d.b("\n"+c),d.b('	<div class="scroll scroll-dark emotes-all">\r'),d.b("\n"+c),d.b('		<div class="tse-content emotes-container"></div>\r'),d.b("\n"+c),d.b("	</div>\r"),d.b("\n"+c),d.b('	<p class="dropmenu_alt_section">\r'),d.b("\n"+c),d.b('		<a class="left icon github" href="https://github.com/cletusc/Userscript--Twitch-Chat-Emotes" target="_blank" title="Visit the project page on Github"></a>\r'),d.b("\n"+c),d.b('		<a class="left icon popular-emotes-location" title="Change popular emotes location"></a>\r'),d.b("\n"+c),d.b('		<a class="reset" title="Reset the popularity of the emotes back to default">Reset Popularity</a>\r'),d.b("\n"+c),d.b('		<a class="right icon resize-handle"></a>\r'),d.b("\n"+c),d.b("	</p>\r"),d.b("\n"+c),d.b("</div>\r"),d.b("\n"),d.fl()}),B.newsMessage=new A.Template(function(a,b,c){var d=this;return d.b(c=c||""),d.b("\r"),d.b("\n"+c),d.b('<div class="twitch-chat-emotes-news">\r'),d.b("\n"+c),d.b("	["),d.b(d.v(d.f("scriptName",a,b,0))),d.b("] News: "),d.b(d.t(d.f("message",a,b,0))),d.b(' (<a href="#" data-command="twitch-chat-emotes:dismiss-news" data-news-id="'),d.b(d.v(d.f("id",a,b,0))),d.b('">Dismiss</a>)\r'),d.b("\n"+c),d.b("</div>\r"),d.b("\n"),d.fl()}),B.style=new A.Template(function(a,b,c){var d=this;return d.b(c=c||""),d.b("#chat_emote_dropmenu_button:not(.newlayout) span {\r"),d.b("\n"+c),d.b('	background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAYAAAAbBi9cAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKUSURBVDhPfZTNi1JRGMZvMIsWUZts5SIXFYK0CME/IGghxVC7WUoU1NBixI+mRSD4MQzmxziKO3XUBhRmUGZKdBG40XEGU6d0GFGZcT4qxW1hi7fzvNwZqKwDD5z7vs/vueeee+6VMJxO5wUhhdvtfuHz+T4tLS2NhegfGsMDLxiwHIIhLi57PJ75VCr1Y39/n4bDIY1Go4lCDx54wYCVYzjoVjQa/dxutyfCkwSvYJpgOSQf708tuBa1yWRy/L+V/Cl4wYBFhhTxfLhum/esiiJ1u12KRCJksVhofX2dTk5OzkHMUUMPHnjB2F55VpEhPde/Lbx8FqBEIkHpdJoMBgNptVrS6XRUqVTOg7a3t2lmZob0ej2p1Wr2ggGLDOnJ3QSZH4coHo/TysoKhygUCtJoNFQsFmkwGLAwR7hSqSSVSsVeMGCRIT29F6fXJi8Xy+Uymc1mmp6eJofDQfV6nU5PT1mY2+127uHxSqUSh4FFhhQLvrvtcrm+YpkHBwdUrVZpa2uLarUadTodOjw8ZGGOGnrwwAsGLDLw1i4uLrzRYeOOj49pb2+Pdnd3qdVq8StGAIQ5ao1Ggz3wggGLDD4C4izcEcWfR0dHbMrlcrSxscGbjVAIK8lms7S5ucmB/X6fXz9YDsEQFzdjsVit2Wzyqc1kMrwfVquVjEYjzc3NkclkIpvNRmtra+yBVzAfBXtDjuGgS8FgcFbc8QvuhjNSKBQoFAqR6LFEn/L5PPfggXd5eXkWrBzDQdC1QCBgFoeut7Ozw/tyBp2FQzhPwtOFFwzY34Yo4A9wRXzdD8LhcE48wncE9no9Fuaoid574bkPLxgZ/3uI5pTQVfFlP/L7/Wmhb7JSXq/3IXrwyHZ5SNIvGCnqyh+J7+gAAAAASUVORK5CYII=") no-repeat 50%;\r'),d.b("\n"+c),d.b("	cursor: pointer;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu_button.newlayout {\r"),d.b("\n"+c),d.b('	background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAAQCAYAAAAbBi9cAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAKUSURBVDhPfZTNi1JRGMZvMIsWUZts5SIXFYK0CME/IGghxVC7WUoU1NBixI+mRSD4MQzmxziKO3XUBhRmUGZKdBG40XEGU6d0GFGZcT4qxW1hi7fzvNwZqKwDD5z7vs/vueeee+6VMJxO5wUhhdvtfuHz+T4tLS2NhegfGsMDLxiwHIIhLi57PJ75VCr1Y39/n4bDIY1Go4lCDx54wYCVYzjoVjQa/dxutyfCkwSvYJpgOSQf708tuBa1yWRy/L+V/Cl4wYBFhhTxfLhum/esiiJ1u12KRCJksVhofX2dTk5OzkHMUUMPHnjB2F55VpEhPde/Lbx8FqBEIkHpdJoMBgNptVrS6XRUqVTOg7a3t2lmZob0ej2p1Wr2ggGLDOnJ3QSZH4coHo/TysoKhygUCtJoNFQsFmkwGLAwR7hSqSSVSsVeMGCRIT29F6fXJi8Xy+Uymc1mmp6eJofDQfV6nU5PT1mY2+127uHxSqUSh4FFhhQLvrvtcrm+YpkHBwdUrVZpa2uLarUadTodOjw8ZGGOGnrwwAsGLDLw1i4uLrzRYeOOj49pb2+Pdnd3qdVq8StGAIQ5ao1Ggz3wggGLDD4C4izcEcWfR0dHbMrlcrSxscGbjVAIK8lms7S5ucmB/X6fXz9YDsEQFzdjsVit2Wzyqc1kMrwfVquVjEYjzc3NkclkIpvNRmtra+yBVzAfBXtDjuGgS8FgcFbc8QvuhjNSKBQoFAqR6LFEn/L5PPfggXd5eXkWrBzDQdC1QCBgFoeut7Ozw/tyBp2FQzhPwtOFFwzY34Yo4A9wRXzdD8LhcE48wncE9no9Fuaoid574bkPLxgZ/3uI5pTQVfFlP/L7/Wmhb7JSXq/3IXrwyHZ5SNIvGCnqyh+J7+gAAAAASUVORK5CYII=") !important;\r'),d.b("\n"+c),d.b("	background-position: 50%;\r"),d.b("\n"+c),d.b("	cursor: pointer;\r"),d.b("\n"+c),d.b("	margin-left: 7px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu {\r"),d.b("\n"+c),d.b("	padding: 5px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu {\r"),d.b("\n"+c),d.b("	background-color: #202020;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu h4 {\r"),d.b("\n"+c),d.b("	text-align: center;\r"),d.b("\n"+c),d.b("	padding: 3px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .emotes-popular {\r"),d.b("\n"+c),d.b("	height: 38px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .draggable {\r"),d.b("\n"+c),d.b("	background-image: repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(255, 255, 255, 0.05) 5px, rgba(255, 255, 255, 0.05) 10px);\r"),d.b("\n"+c),d.b("	cursor: move;\r"),d.b("\n"+c),d.b("	height: 7px;\r"),d.b("\n"+c),d.b("	margin-bottom: 3px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .draggable:hover {\r"),d.b("\n"+c),d.b("	background-image: repeating-linear-gradient(45deg, transparent, transparent 5px, rgba(255, 255, 255, 0.1) 5px, rgba(255, 255, 255, 0.1) 10px);\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b(".twitch-chat-emotes-news {\r"),d.b("\n"+c),d.b("	border: 1px solid rgba(100, 65, 165, 0.5);\r"),d.b("\n"+c),d.b("	padding: 2px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b(".twitch-chat-emotes-news a {\r"),d.b("\n"+c),d.b("	color: #6441a5 !important;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .userscript_emoticon_header {\r"),d.b("\n"+c),d.b("	border-top: 1px solid black;\r"),d.b("\n"+c),d.b("	box-shadow: 0 1px 0 rgba(255, 255, 255, 0.05) inset;\r"),d.b("\n"+c),d.b("	background-image: linear-gradient(to top, transparent, rgba(0, 0, 0, 0.5));\r"),d.b("\n"+c),d.b("	padding: 2px;\r"),d.b("\n"+c),d.b("	text-align: center;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .userscript_emoticon_header img {\r"),d.b("\n"+c),d.b("	margin-right: 8px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .userscript_emoticon {\r"),d.b("\n"+c),d.b("	display: inline-block;\r"),d.b("\n"+c),d.b("	padding: 2px;\r"),d.b("\n"+c),d.b("	margin: 1px;\r"),d.b("\n"+c),d.b("	cursor: pointer;\r"),d.b("\n"+c),d.b("	border-radius: 5px;\r"),d.b("\n"+c),d.b("	text-align: center;\r"),d.b("\n"+c),d.b("	width: 32px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .userscript_emoticon .emoticon {\r"),d.b("\n"+c),d.b("	max-width: 32px;\r"),d.b("\n"+c),d.b("	margin: 0 !important;\r"),d.b("\n"+c),d.b("	height: 32px;\r"),d.b("\n"+c),d.b("	background-size: contain;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .userscript_emoticon:hover {\r"),d.b("\n"+c),d.b("	background-color: rgba(255, 255, 255, 0.1);\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section a {\r"),d.b("\n"+c),d.b("	cursor: pointer;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section .left {\r"),d.b("\n"+c),d.b("	float: left;\r"),d.b("\n"+c),d.b("	margin-right: 5px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section .right {\r"),d.b("\n"+c),d.b("	float: right;\r"),d.b("\n"+c),d.b("	margin-left: 5px;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section a.icon {\r"),d.b("\n"+c),d.b("	height: 16px;\r"),d.b("\n"+c),d.b("	width: 16px;\r"),d.b("\n"+c),d.b("	opacity: 0.5;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section a.icon:hover {\r"),d.b("\n"+c),d.b("	opacity: 1.0;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section a.github {\r"),d.b("\n"+c),d.b("	/**\r"),d.b("\n"+c),d.b('	 * "The mark": inverted color to suit dark theme and resized to 16x16.\r'),d.b("\n"+c),d.b("	 * @attribution Github, Inc. (https://github.com/logos)\r"),d.b("\n"+c),d.b("	 */\r"),d.b("\n"+c),d.b('	background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAALiIAAC4iAari3ZIAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAWpJREFUOE+F0ssrRGEYx/EZBhs2ssHCrCasFf4DFiKyERuytRMZESl3WxsbK0s2FlKKxkIJOyRpEgtyv19yfH/H87qm86tPvee9POd5z0zodzzPK8I4NnFuNjCKmG37GxbTMYEXrKMb9aYHKviMYaTZsY8wocPzOEENbOUrzIWhYmeYQ8SW/MUxnKICekMhNJ+FTBvraiOohK414A7HoNbqUAvlCcd4NRprj1KFBmhPVAWGsAXXYlCqkYJt9KnAGvrhxkFJWOe66ooGaq8REdwgKBdQBy1IqsARmqArqFhQktC5VhxosIpBa2sKQZm0vfrPLGmg++uD5KAYKvhflpGNVOwjrgIFeEAbZhFFGXbhkkAJwvZ2tX+HPD1rohdXtnAI/axvcPE/nO0thT52p39Y4UEtzeAS7SjHI1zUYQaacY1p+AU/w4SKxHEPfRP9A1003sEt9IKfh7+HxXx0YRF7ZgEdyLVtllDoHUPsDkVplXakAAAAAElFTkSuQmCC") no-repeat 50%;\r'),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section a.popular-emotes-location {\r"),d.b("\n"+c),d.b('	background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAgCAYAAAAbifjMAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAClSURBVEhL7ZRBDoAgEAN9uj9fKaFkl61EiN5sMgcLnYMHDjObcTbUWUWWDQyZW4ksC37MSEkqCmrMJEn4KMzGTJCsjpku2RkzVbI7Zk4KFGPUnSpQ4HAMunQ3FY1f8IIAYOBRd74TYDBGSlLR+AWLAhwoxqg7/T3YTX8PdiTYhH+wIqlj4AVPJX0M/JjMJGEMwodDSdIYpMLhJXIMZOnA8HZsZscFnEfNs2qCgdQAAAAASUVORK5CYII=") no-repeat 50% top;\r'),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section a.popular-emotes-location.popular-on-bottom {\r"),d.b("\n"+c),d.b("	background-position: bottom;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"+c),d.b("#chat_emote_dropmenu .dropmenu_alt_section a.resize-handle {\r"),d.b("\n"+c),d.b('	background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwgAADsIBFShKgAAAABp0RVh0U29mdHdhcmUAUGFpbnQuTkVUIHYzLjUuMTAw9HKhAAAAX0lEQVQ4T6WPUQ7AIAhDPfpuzuyHxpGK7SR5IVYeCS0irqChAw0daOhAQwcaijyAfShARv1aMOWOfcJHBnmgIsvo8glMRkkLtnLneEIpg3U4c5LRtycoMqpcMIaLd7QXl2chH51cR7QAAAAASUVORK5CYII=") no-repeat 50%;\r'),d.b("\n"+c),d.b("	cursor: nwse-resize;\r"),d.b("\n"+c),d.b("}\r"),d.b("\n"),d.fl()});var C,D,E,F,G,H,I,J={usable:[],get raw(){return b.CurrentChat?b.CurrentChat.emoticons:b.App?b.App.__container__.lookup("controller:emoticons").get("emoticons"):[]},subscriptions:{badges:{},emotes:{}}},K=!1,L=!1,M="Twitch Chat Emotes",N="#twitch-chat-emotes-debug"===location.hash,O=!1,P={ALREADY_RUNNING:"There is already an instance of this script running, cancelling this instance.",NO_CHAT_ELEMENT:"There is no chat element on the page, unable to continue.",NOT_LOGGED_IN:"You are not logged in, please log in first before using the emote menu.",OBJECTS_NOT_LOADED:"Needed objects haven't loaded yet.",TIMEOUT_SCRIPT_LOAD:"Script took too long to load. Refresh to try again."};for(var Q in P)P.hasOwnProperty(Q)&&(P[Q]="["+M+"]: "+P[Q]);!function R(a){if(b.App===d)return R(a);L||(b.App.ChannelRoute.reopen({activate:function(){this._super(),R(50)}}),L=!0);var c=b.Twitch&&b.Twitch.user.isLoggedIn(),f=b.Twitch!==d&&(b.CurrentChat!==d&&b.CurrentChat.emoticons!==d&&b.CurrentChat.emoticons.length||b.App!==d&&b.App.__container__!==d&&b.App.__container__.lookup("controller:emoticons").get("emoticons")!==d&&b.App.__container__.lookup("controller:emoticons").get("emoticons").length)&&b.$j!==d&&document.querySelector("#chat_speak, .send-chat-button");if(document.querySelector("#chat_emote_dropmenu_button"))return void console.warn(P.ALREADY_RUNNING);if(!f||!c){if(a>=6e4)return console.error(P.TIMEOUT_SCRIPT_LOAD),void t(P.NOT_LOGGED_IN);if(a>=1e4){if(!c)return console.error(P.NOT_LOGGED_IN),void t(P.NOT_LOGGED_IN);f||console.warn(P.OBJECTS_NOT_LOADED)}return void setTimeout(R,a,2*a)}e()}(50)}(this.unsafeWindow||window,window.chrome?!0:!1);